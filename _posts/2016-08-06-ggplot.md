Starting with R Visualization
========================================================
author: loiyumba
date: 
autosize: true

Visualization with R
========================================================

There are many ways to visualize plots in R. The most famous is ggplot2 package. And we will learn how to plot in R using ggplot2 package. Apart from ggplot2, we can use    

- R base graphic   
- lattice package    
- ggvis(still developing) package.    

We will also need some additional packages to make our plots elegant.


Scatter plot
==========================================

We load the package first.

```r
library(ggplot2) # visualization
library(ggthemes) # plot themes
library(grid) # visualization
library(dplyr) # data wrangling
```

We will visualize an R in-built data `airquality`

```r
aq <- na.omit(airquality) # remove all the NAs
aq_scatter <- ggplot(aq, aes(x = Day, y = Ozone)) + 
  geom_point()
```

==================

![plot of chunk unnamed-chunk-3](ggplot-figure/unnamed-chunk-3-1.png)


Line Plot
====================================


```r
aq_line <- ggplot(aq, aes(x = Day, y = Ozone, color = factor(Month))) +
  geom_line()
```

=====================

![plot of chunk unnamed-chunk-5](ggplot-figure/unnamed-chunk-5-1.png)

Bar Plot
========================


```r
aq_bar <- ggplot(aq, aes(x = Month, y = Ozone)) +
  geom_bar(stat = "identity")
```

==================

![plot of chunk unnamed-chunk-7](ggplot-figure/unnamed-chunk-7-1.png)

Histogram
=================


```r
aq_hist <- ggplot(aq, aes(x = Ozone)) +
  geom_histogram()
```

==========================

![plot of chunk unnamed-chunk-9](ggplot-figure/unnamed-chunk-9-1.png)


Box plot
=========================


```r
aq_box <- ggplot(aq, aes(x = factor(Month), y = Ozone)) +
  geom_boxplot()
```

========================

![plot of chunk unnamed-chunk-11](ggplot-figure/unnamed-chunk-11-1.png)

Some Other Graphs
================================

There are other miscellaneous graphs -    
- Network Graph    
- Heat Map   
- Three-Dimentional Scatter plot   
- Pie Chart   
- Dendrogram   
- Map   
- etc. 


Heat Map
============================


```r
aq_hm <- ggplot(aq, aes(x = Day, y = Month, fill = Temp)) + geom_tile()
```

=======================

![plot of chunk unnamed-chunk-13](ggplot-figure/unnamed-chunk-13-1.png)


Customisations of Plots
====================================

### Scatter plot customizations


```r
a_q <- filter(aq, Month == 7 | Month == 8 | Month == 9)
count(a_q, Month)
```

```
# A tibble: 3 x 2
  Month     n
  <int> <int>
1     7    26
2     8    23
3     9    29
```

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone)) +
  geom_point()
```

============================

This is the basic scatter plot    

![plot of chunk unnamed-chunk-16](ggplot-figure/unnamed-chunk-16-1.png)


======================

On the existing plot, we will customize step by step.

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone)) +
  geom_point(shape = 21, size = 4) ###
```

============================

Shape and size of data point is changed
![plot of chunk unnamed-chunk-18](ggplot-figure/unnamed-chunk-18-1.png)

=========================

Adjusting the axis scales

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone)) +
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) ###
```

=================

![plot of chunk unnamed-chunk-20](ggplot-figure/unnamed-chunk-20-1.png)

======================

Adding plot title and changing axis labels

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone)) +
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") + ###
  labs(x = "Day of the Month", y = "Ozone (ppb)") ###
```

=======================

![plot of chunk unnamed-chunk-22](ggplot-figure/unnamed-chunk-22-1.png)


=================

Colouring the scatter points

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone)) +
  geom_point(shape = 21, size = 4, fill = "cornflowerblue") + ###
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)")
```

Full list of colours recognised by R is [here](http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf)


======================

![plot of chunk unnamed-chunk-24](ggplot-figure/unnamed-chunk-24-1.png)

====================

Changing the colour scatter points with another variable

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Wind)) + ###
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)")
```

==========================

![plot of chunk unnamed-chunk-26](ggplot-figure/unnamed-chunk-26-1.png)

=======================

Changing the colour of gradient

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Wind)) +
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)") +
  scale_fill_continuous(low = "brown1", high = "brown4") ###
```

===================

![plot of chunk unnamed-chunk-28](ggplot-figure/unnamed-chunk-28-1.png)

=========================

We will plot another variable - Month, but first change it to factor.

```r
a_q$Month <- factor(a_q$Month, labels = c("July", "August", "September"))
glimpse(a_q)
```

```
Observations: 78
Variables: 6
$ Ozone   <int> 135, 49, 32, 64, 40, 77, 97, 97, 85, 10, 27, 7, 48, 35...
$ Solar.R <int> 269, 248, 236, 175, 314, 276, 267, 272, 175, 264, 175,...
$ Wind    <dbl> 4.1, 9.2, 9.2, 4.6, 10.9, 5.1, 6.3, 5.7, 7.4, 14.3, 14...
$ Temp    <int> 84, 85, 81, 83, 83, 88, 92, 92, 89, 73, 81, 80, 81, 82...
$ Month   <fctr> July, July, July, July, July, July, July, July, July,...
$ Day     <int> 1, 2, 3, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18, 19...
```

========================


```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Month)) + ###
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)")
```

===========================

![plot of chunk unnamed-chunk-31](ggplot-figure/unnamed-chunk-31-1.png)

====================

We change the colour of scatter points

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Month)) + 
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)") +
  scale_fill_manual(values = c("deeppink", "deepskyblue", "gold")) ###
```

============================

![plot of chunk unnamed-chunk-33](ggplot-figure/unnamed-chunk-33-1.png)

============================

Moving legend around

```r
scatter <- scatter +
  theme(legend.position = "bottom", legend.direction = "horizontal") ###
```

================================

![plot of chunk unnamed-chunk-35](ggplot-figure/unnamed-chunk-35-1.png)


==============================

Changing the theme of plot. We will use ggthemes package to get our desire theme.

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Month)) + 
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)", fill = "Months ") + ###
  scale_fill_manual(values = c("deeppink", "deepskyblue", "gold")) +
  theme_bw() +  ###
  theme(legend.position = "bottom", legend.direction = "horizontal")
```

======================

![plot of chunk unnamed-chunk-37](ggplot-figure/unnamed-chunk-37-1.png)

===========================

The Economist theme

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Month)) + 
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)") +
  scale_fill_manual(values = c("deeppink", "deepskyblue", "gold")) +
  theme_economist() +  ###
  theme(legend.position = "bottom", legend.direction = "horizontal")
```

====================

![plot of chunk unnamed-chunk-39](ggplot-figure/unnamed-chunk-39-1.png)

====================

Five Thirty Eight theme

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Month)) + 
  geom_point(shape = 21, size = 4) +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)") +
  theme_fivethirtyeight() + scale_fill_fivethirtyeight() + ###
  theme(legend.position = "bottom", legend.direction = "horizontal")
```

=========================

![plot of chunk unnamed-chunk-41](ggplot-figure/unnamed-chunk-41-1.png)

XKCD Style
=========================

In order to create XKCD style, we have to load windows xkcd font using extrafont package.   
Install extrafont package from cran.   
Once installed, load the package and then we have to run loadfonts(), this will load all the windows font available for us to use in R. This may take few minutes. Once it is done, we can check all the available fonts with font() function. 

```r
library(extrafont)
windowsFonts(xkcd=windowsFont("xkcd"))
```

========================

```r
scatter <- ggplot(a_q, aes(x = Day, y = Ozone, fill = Month)) +
  geom_point(shape = 21, size = 4) +
  ggtitle("Air Quality in New York by Day") +
  labs(x = "Day of the Month", y = "Ozone (ppb)") +
  scale_x_continuous(breaks = seq(1, 31, 5)) +
  theme(legend.position = "bottom", legend.direction = "horizontal") +       theme(plot.title = element_text(size = 20, family = "xkcd"),
  text = element_text(size = 15, family = "xkcd"),
  panel.background = element_blank(),
  axis.line.x = element_line(size = .6, colour = "black"),
  axis.line.y = element_line(size = .6, colour = "black"))
```

===================

![plot of chunk unnamed-chunk-44](ggplot-figure/unnamed-chunk-44-1.png)

=========================

### Line plot customizations    

For this we will build a demo data.

```r
year <- 2010:2016
product <- rep(c("Pineapple", "Ginger"), each = 7)
export <- c(200, 250, 400, 100, 150, 320, 200,850, 700, 900, 800, 750, 830, 880)
exp <- data.frame(year, product, export)
str(exp)
```

```
'data.frame':	14 obs. of  3 variables:
 $ year   : int  2010 2011 2012 2013 2014 2015 2016 2010 2011 2012 ...
 $ product: Factor w/ 2 levels "Ginger","Pineapple": 2 2 2 2 2 2 2 1 1 1 ...
 $ export : num  200 250 400 100 150 320 200 850 700 900 ...
```

==================


```r
exp
```

```
   year   product export
1  2010 Pineapple    200
2  2011 Pineapple    250
3  2012 Pineapple    400
4  2013 Pineapple    100
5  2014 Pineapple    150
6  2015 Pineapple    320
7  2016 Pineapple    200
8  2010    Ginger    850
9  2011    Ginger    700
10 2012    Ginger    900
11 2013    Ginger    800
12 2014    Ginger    750
13 2015    Ginger    830
14 2016    Ginger    880
```

=======================

Basic line plot

```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) + geom_line()
```

==================

![plot of chunk unnamed-chunk-48](ggplot-figure/unnamed-chunk-48-1.png)

======================

Line width

```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) + geom_line(size = 1) ###
```

=======================

![plot of chunk unnamed-chunk-50](ggplot-figure/unnamed-chunk-50-1.png)

======================

x-axis scale

```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) + 
  geom_line(size = 1) +
  scale_x_continuous(breaks = seq(2010, 2016, 1)) ###
```

=====================

![plot of chunk unnamed-chunk-52](ggplot-figure/unnamed-chunk-52-1.png)

=====================

Legend position

```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) + 
  geom_line(size = 1) +
  scale_x_continuous(breaks = seq(2010, 2016, 1)) +
  theme(legend.position = "bottom", legend.direction = "horizontal", legend.title = element_blank()) ###
```

=====================

![plot of chunk unnamed-chunk-54](ggplot-figure/unnamed-chunk-54-1.png)

====================

Title and axis labels

```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) + 
  geom_line(size = 1) +
  scale_x_continuous(breaks = seq(2010, 2016, 1)) +
  ggtitle("Ginger and Pineapple Export") + ###
  labs(x = "Year", y = "Tonne") + ###
  theme(legend.position = "bottom", legend.direction = "horizontal", legend.title = element_blank())
```

============================

![plot of chunk unnamed-chunk-56](ggplot-figure/unnamed-chunk-56-1.png)

Change the colour of lines
================================


```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) +         geom_line(size = 1) +
  scale_x_continuous(breaks = seq(2010, 2016, 1)) +
  ggtitle("Ginger and Pineapple Export") +
  labs(x = "Year", y = "Tonne") + 
  theme(legend.position = "bottom", legend.direction = "horizontal", legend.title = element_blank()) +
  scale_colour_manual(values = c("darkorchid", "darkolivegreen")) ###
```

============================

![plot of chunk unnamed-chunk-58](ggplot-figure/unnamed-chunk-58-1.png)

White Theme
==================================


```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) +         geom_line(size = 1) +
  scale_x_continuous(breaks = seq(2010, 2016, 1)) +
  ggtitle("Ginger and Pineapple Export") +
  labs(x = "Year", y = "Tonne") + 
  theme_bw() + ###
  theme(legend.position = "bottom", legend.direction = "horizontal", legend.title = element_blank()) +
  scale_colour_manual(values = c("darkorchid", "darkolivegreen")) 
```

===========================

![plot of chunk unnamed-chunk-60](ggplot-figure/unnamed-chunk-60-1.png)


The Economist Theme
====================


```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) +         geom_line(size = 1) +
  scale_x_continuous(breaks = seq(2010, 2016, 1)) +
  ggtitle("Ginger and Pineapple Export") +
  labs(x = "Year", y = "Tonne") + 
  theme_economist() + scale_colour_economist() + ###
  theme(legend.position = "bottom", legend.direction = "horizontal", legend.title = element_blank(),
        axis.line.x = element_line(size = .5, colour = "black")) ###
```

====================

![plot of chunk unnamed-chunk-62](ggplot-figure/unnamed-chunk-62-1.png)


Five Thirty Eight Theme
=============================


```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) +  
  geom_line(size = 1) +
  scale_x_continuous(breaks = seq(2010, 2016, 1)) +
  ggtitle("Ginger and Pineapple Export") +
  labs(x = "Year", y = "Tonne") + 
  theme_fivethirtyeight() + scale_colour_fivethirtyeight() + ###
  theme(legend.position = "bottom", legend.direction = "horizontal", legend.title = element_blank())
```

========================

![plot of chunk unnamed-chunk-64](ggplot-figure/unnamed-chunk-64-1.png)

XKCD Theme
========================


```r
expVis <- ggplot(exp, aes(x = year, y = export, colour = product)) +  
  geom_line(size = 1) + scale_x_continuous(breaks = seq(2010, 2016, 1)) +
  ggtitle("Ginger and Pineapple Export") + labs(x = "Year", y = "Tonne") + 
  theme(legend.position = "bottom", legend.direction = "horizontal", legend.title = element_blank(), plot.title = element_text(size = 20, family = "xkcd"), text = element_text(size = 15, family = "xkcd"),
        panel.background = element_blank(),
        axis.line.x = element_line(size = .6, colour = "black"),
        axis.line.y = element_line(size = .6, colour = "black")) +
        scale_colour_manual(values = c("darkorchid", "darkolivegreen"))
```

=============

![plot of chunk unnamed-chunk-66](ggplot-figure/unnamed-chunk-66-1.png)


===================

Bar Plot Customizations

For bar plot, we will visualize Euro 2016 data. We import data table from Euro 2016 official [website](http://www.uefa.com/uefaeuro/season=2016/statistics/round=2000448/teams/index.html)   

For importing data table from html pages, we will use a package call "rvest".   

```r
library(rvest)
```

Data Import
====================






```
Error in con[[1]] : subscript out of bounds
```
