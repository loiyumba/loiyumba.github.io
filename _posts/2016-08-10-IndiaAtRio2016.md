---
layout: post
title: India at Rio Summer Olympics 2016
subtitle: Exploratory data analysis of Indian Olympians
fb-img: https://github.com/loiyumba/loiyumba.github.io/blob/master/img/Rio2016/EventWise.png
---     

India's performance in Olympics has always been a lackluster event. Read somewhere that performance of a country in Olympic event is 
directly correlate to country's GDP. Maybe true because those countries who tops the Olympic medals table are mostly developed countries.
For Indians, if the Indian Olympians could bring some medals, we are happy. Because we are one sports nation - Cricket. This game is a
religion in our country and the cricket players are God. Fortunate are those sportsmen who made into cricket. Sportsmen in other games go
through a lot of hurdles and the rides are not smooth to reach the tops. Few sportsmen like Viswanathan Anand, Mary Kom, Sania Mirza,
Saina Nehwal, Vijender Singh and Sunil Chhetri from other sports made their names but don't get similar fame and perks of a famous 
cricketer. So every time during the Olympics, there will be debates and discussions on every media stating why India struggles so much to
earn medals in the Olympics. There could be many reasons which need to fix for India to perform in the Olympics. I am more interested in
the information part of the Indian Olympics. I have searched data from various sources on the web, copied data from Wikipedia posts to
visualize data so that I can get a better understanding of the data.     

Like my other posts, I am going to post this as a tutorial kind of. I am going to add the codes on how I have copied the data from
Wikipedia site, how I generated the plots and maps.     

Just like any R code begins, we load the require libraries first.    

```r
require(rvest) # to copy data table from html pages
require(dplyr) # for data wrangling
require(ggplot2) # for visualization
require(tidyr) # for data transformation
require(plyr) # for assisting data transformation in visualization
```    

Getting and Transforming Data
----

The data table for events participating by Indian athletes in Rio Olympics 2015 is available [here](https://en.wikipedia.org/wiki/India_at_the_2016_Summer_Olympics),
and with the help `rvest` package, we will transfer the table to R.     

```r
wikiLink <- read_html("https://en.wikipedia.org/wiki/India_at_the_2016_Summer_Olympics")

eventList <- wikiLink %>% 
  html_nodes("table") %>% 
  .[[3]] %>% 
  html_table()
```     

We first save as an object the wiki URL where the table is. Then point the number of the table in the page and load it in R. Go ahead
and save the transferred table to your local disk.    

```r
write.csv(eventList, "events.csv", row.names = FALSE)
```    

Here're the first few rows of the table.    

| Sports | Men | Women | Total | Events 
|---     |---  |---    |---    |---     |
| Archery | 1 | 3 | 4 | 3 |
| Athletics | 17 | 17 | 34 | 20 |
| Badminton | 3 | 4 | 7 | 4 |
| Boxing | 3 | 0 | 3 | 3 |
| Field Hockey | 18 | 18 | 36 | 2 |
| Golf | 2 | 1 | 3 | 2 |    

We can drop the feature _Events_ and drop the row which is _Total_ and arrange the table by _Total_ in descending. Note that there is a row in the _Sports_ feature call _Total_ which sums the number of _Men_, _Women_ and _Total_ features.   

```r
events <- select(eventList, Sports, Men, Women, Total)
events <- select(events, Sports, Men, Women, Total)
events <- filter(events, Sports != "Total")
events <- arrange(events, desc(Total))
```    

In order to make our desire plot, I need to make some transformation on data with the help of `tidyr` package- from wide format of the table to long format of the table.     

```r
eventsLong <- gather(events, "Gender", "Number", 2:3)
```    

Here I have made a new feature call _Gender_ which will take _Men_ and _Women_ features from events data and another new feature call
_Number_ which will count the number of each gender in their respective sports events. 2:3 is the selection of columns that we want to transform. The new table looks like this-    

| Sports | Total | Gender | Number 
|---     |---    |---     |---  |
| Field Hockey | 36 | Men | 18 |
| Athletics | 34 | Men | 17 |
| Shooting | 12 | Men | 9 |
| Wrestling | 8 | Men | 5 |
| Badminton | 7 | Men | 3 |
| Archery | 4 | Men | 1 |      

While transforming the table into long format, we have generated quite a few rows with 0 in the _Number_ feature. We will remove all those rows.   

```r
eventsLong <- filter(eventsLong, Number != 0)
```   

Visualizing Data
----   

While making stacked bar plot, I have struggled to keep the value of each bar in the center previously. With the help from a [StackOverFlow answer](http://stackoverflow.com/questions/6644997/showing-data-values-on-stacked-bar-chart-in-ggplot2), I was able to fix it.   

```r
newList <- ddply(eventsLong, .(Sports), transform,
                 pos = cumsum(Number) - (0.5 * Number))
```    

This is the complete code to generate the stacked bar plot of Olympic events that Indian athletes are going to participate.     

```r
bp <- 
ggplot(newList, aes(x = reorder(Sports, Number), y = Number, fill = Gender)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  ggtitle("India at 2016 Summer Olympics") +
  labs(x = "", y = "Numbers of Athletes") +
  geom_text(aes(x = Sports, y = pos, label = Number), size = 4, 
            colour = "white", fontface = "bold") +
  annotate("text", x = 1, y = 26, 
           label = "Data Source: https://en.wikipedia.org/wiki/India_at_the_2016_Summer_Olympics") +
  scale_fill_manual(values = c("firebrick", "firebrick1")) +
  theme(legend.position = "bottom",
        legend.direction = "horizontal",
        panel.background = element_blank(),
        axis.line.x = element_line(size = .6, colour = "black"),
        axis.text = element_text(size = 12)) 

bp + geom_text(aes(x = Sports, y = Total + 0.5, label = Total, fill = NULL),
               size = 4, data = indiaList)
```    

The above code generate this plot below.    

[![events]({{ site.url }}/img/Rio2016/EventWise.png)]({{ site.url }}/img/Rio2016/EventWise.png)     

